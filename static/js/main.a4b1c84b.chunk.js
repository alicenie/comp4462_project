(this.webpackJsonpcomp4462_project=this.webpackJsonpcomp4462_project||[]).push([[0],{260:function(t,e,n){},261:function(t,e,n){},280:function(t,e,n){"use strict";n.r(e);var a=n(2),r=n.n(a),i=n(23),o=n.n(i),c=(n(260),n.p,n(261),n(0));var s=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,281)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,i=e.getLCP,o=e.getTTFB;n(t),a(t),r(t),i(t),o(t)}))},d=n(5),l=n(6),p=n(8),u=n(9),h=n(135),g=n.n(h),b=(n(134),n(1)),j=function(t){Object(p.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(d.a)(this,n),(a=e.call(this,t)).priorityColor=function(t,e){return b.j().domain([10,100]).range(["PeachPuff","FireBrick"])(e[t.properties.Id-1])},a.drawCityMap=function(){b.h("https://raw.githubusercontent.com/huantingwei/comp4462/main/StHimark.geojson").then((function(t){console.log("geoData",t);var e=[10,20,50,100,20,15,25,35,50,70,85,25,50,70,85,25,50,70,10],n=10,r=10,i=5,o=10,c=700-n-r,s=370-i-o;b.l("#citymap").selectAll("svg").remove();var d=b.l("#citymap").append("svg").attr("width",c+n+r).attr("height",s+i+o).append("g").attr("transform","translate("+n+","+i+")"),l=b.d().fitSize([c,s],t),p=b.e(l);d.selectAll("path").data(t.features).enter().append("path").attr("d",p).style("stroke","#fff").style("fill",(function(t){return a.priorityColor(t,e)})).attr("class","areas").on("mouseover",(function(t,e){b.l(this).attr("opacity",.5)})).on("mouseout",(function(t,e){b.l(this).attr("opacity",1)})).on("click",(function(t,e){var n=[e.properties.Id,e.properties.Nbrhood];a.props.onSelectRegion(n)})),d.selectAll(".labels").data(t.features).enter().append("text").attr("class","labels").attr("x",(function(t){return p.centroid(t)[0]})).attr("y",(function(t){return p.centroid(t)[1]})).attr("text-anchor","middle").attr("font-size","10px").text((function(t){return t.properties.Nbrhood.toString()}))})).catch((function(t){console.log("error in loading geojson!")}))},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.drawCityMap()}},{key:"render",value:function(){return Object(c.jsx)("div",{id:"citymap"})}}]),n}(r.a.Component),m=n(26),y=function(t){Object(p.a)(n,t);var e=Object(u.a)(n);function n(t){var a;Object(d.a)(this,n),(a=e.call(this,t)).drawLegend=function(t,e){var n=m.a.arcmapLegend();n.scale(t).size(160).x(0).y(0).vtitle("Intensity Reported").utitle("Uncertainty"),b.l("#vsupLegend").selectAll("svg").remove(),b.l("#vsupLegend").append("svg").attr("width",300).attr("height",300).append("g").attr("transform","translate(15,40)").append("g").call(n),b.l("#colorLegend").selectAll("svg").remove();var a=b.l("#colorLegend").append("svg").attr("width",180).attr("height",60).append("g"),r=a.append("defs").append("linearGradient").attr("id","linear-gradient");r.attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%"),r.append("stop").attr("offset","0%").attr("stop-color",e(1)),r.append("stop").attr("offset","50%").attr("stop-color",e(5)),r.append("stop").attr("offset","100%").attr("stop-color",e(10)),a.append("rect").attr("width",160).attr("height",20).style("fill","url(#linear-gradient)").attr("x",10).attr("y",10),a.append("text").text("1").attr("x",10).attr("y",45),a.append("text").text("10").attr("x",160).attr("y",45)},a.drawHeatmap=function(t,e){b.c("./merge_ui.csv").then((function(n){console.log("rawdata",n);for(var r=Date.parse("2020-04-08 6:00:00"),i=[],o=[],c=function(t){var e=r+18e5*t,c=new Date(e),s=c.getFullYear()+"-"+(c.getMonth()+1).toString().padStart(2,"0")+"-"+c.getDate().toString().padStart(2,"0")+" "+c.getHours().toString().padStart(2,"0")+":"+c.getMinutes().toString().padStart(2,"0")+":"+c.getSeconds().toString().padStart(2,"0"),d=(c.getMonth()+1).toString()+"."+c.getDate()+" "+c.getHours()+":"+c.getMinutes().toString().padStart(2,"0");n.filter((function(t){return t.index==s})).forEach((function(t){var n=0,r=0,o=0;-1!=parseFloat(t.medical_i)&&a.state.attribute.medical&&(n+=parseFloat(t.medical_i),r+=parseFloat(t.medical_u),o+=1),-1!=parseFloat(t.power_i)&&a.state.attribute.power&&(n+=parseFloat(t.power_i),r+=parseFloat(t.power_u),o+=1),-1!=parseFloat(t.sewer_and_water_i)&&a.state.attribute.sewer_and_water&&(n+=parseFloat(t.sewer_and_water_i),r+=parseFloat(t.sewer_and_water_u),o+=1),-1!=parseFloat(t.roads_and_bridges_i)&&a.state.attribute.roads_and_bridges&&(n+=parseFloat(t.roads_and_bridges_i),r+=parseFloat(t.roads_and_bridges_u),o+=1),-1!=parseFloat(t.buildings_i)&&a.state.attribute.buildings&&(n+=parseFloat(t.buildings_i),r+=parseFloat(t.buildings_u),o+=1),i.push({time:e,time_string:d,location:parseInt(t.location),intensity_total:n/o,uncertainty_total:r/o})})),o.push(d)},s=0;s<20;s++)c(s);console.log("heatdata",i);var d=30,l=10,p=30,u=10,h=1200-d-l,g=1e3-p-u;b.l("#heatmap").selectAll("svg").remove();var j=b.l("#heatmap").append("svg").attr("width",h+d+l).attr("height",g+p+u).append("g").attr("transform","translate("+d+","+p+")"),m=b.i().range([0,h]).padding(.1).domain(o);j.append("g").style("font-size","12px").call(b.b(m)).call((function(t){t.select(".domain").remove(),t.selectAll("line").remove()}));var y,f=Array.from({length:19},(function(t,e){return e+1})).map((function(t){return{location:t,intensity_total:i.filter((function(e){return e.location==t})).reduce((function(t,e){return e.intensity_total>0?t+e.intensity_total:t}),0)}}));console.log("location intensity",f),y=a.state.descend?f.sort((function(t,e){return e.intensity_total-t.intensity_total})).map((function(t){return t.location})):f.sort((function(t,e){return t.intensity_total-e.intensity_total})).map((function(t){return t.location})),console.log("yDomain",y);var x=b.i().range([0,g]).domain(y).padding(.1);j.append("g").style("font-size","14px").call(b.a(x)).call((function(t){t.select(".domain").remove(),t.selectAll("line").remove()})),j.selectAll().data(i).enter().append("rect").attr("x",(function(t){return m(t.time_string)})).attr("y",(function(t){return x(t.location)})).attr("width",m.bandwidth()).attr("height",x.bandwidth()).style("fill",(function(n){return a.state.uncertainty?n.intensity_total>0?t(n.intensity_total,n.uncertainty_total):"white":n.intensity_total>0?e(n.intensity_total):"white"}))})).catch((function(t){console.log("error in loading heatmap csv!")}))},a.handleOrder=function(){console.log("handle order");var t=document.getElementById("descendingRadio").checked;a.setState({descend:t})},a.handleAttribute=function(){console.log("handle attribute");var t=document.getElementById("medicalCheck").checked,e=document.getElementById("powerCheck").checked,n=document.getElementById("roads_and_bridgesCheck").checked,r=document.getElementById("sewer_and_waterCheck").checked,i=document.getElementById("buildingsCheck").checked;a.setState({attribute:{medical:t,power:e,roads_and_bridges:n,sewer_and_water:r,buildings:i}})},a.handleUncertainty=function(){console.log("handle uncertainty");var t=document.getElementById("uncertaintyRadio").checked;a.setState({uncertainty:t})};var r=b.j().domain([0,.5,1]).range(["#abd9e9","#fee090","#b2182b"]).interpolate(b.f),i=m.b().branching(2).layers(4).valueDomain([1,10]).uncertaintyDomain([0,1]),o=m.c().quantize(i).range(r),c=b.k().interpolator(b.g).domain([10,-5]);return a.state={start_time:0,end_time:1,descend:!0,attribute:{medical:!0,power:!1,roads_and_bridges:!1,sewer_and_water:!1,buildings:!1},uncertainty:!0,vsupScale:o,colorScale:c},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){console.log("HeatMap did mount..."),this.drawHeatmap(this.state.vsupScale,this.state.colorScale),this.drawLegend(this.state.vsupScale,this.state.colorScale)}},{key:"componentDidUpdate",value:function(){console.log("HeatMap did update..."),this.drawHeatmap(this.state.vsupScale,this.state.colorScale)}},{key:"render",value:function(){return Object(c.jsxs)("div",{class:"row",children:[Object(c.jsxs)("div",{class:"col-10",children:[Object(c.jsxs)("p",{children:["start time: ",this.state.start_time]}),Object(c.jsx)("div",{id:"heatmap"})]}),Object(c.jsxs)("div",{class:"col-2",children:[Object(c.jsx)("span",{children:"Sort by:"}),Object(c.jsx)("br",{}),Object(c.jsx)("input",{type:"radio",name:"orderRadio",id:"ascendingRadio",value:"ascending",onChange:this.handleOrder})," Ascending ",Object(c.jsx)("br",{}),Object(c.jsx)("input",{type:"radio",name:"orderRadio",id:"descendingRadio",value:"descending",onChange:this.handleOrder})," Descending",Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsx)("span",{children:"Selected attribute:"}),Object(c.jsx)("br",{}),Object(c.jsx)("input",{type:"checkbox",id:"medicalCheck",value:"medical",onChange:this.handleAttribute})," Medical ",Object(c.jsx)("br",{}),Object(c.jsx)("input",{type:"checkbox",id:"powerCheck",value:"power",onChange:this.handleAttribute})," Power",Object(c.jsx)("br",{}),Object(c.jsx)("input",{type:"checkbox",id:"roads_and_bridgesCheck",value:"roads_and_bridges",onChange:this.handleAttribute})," Roads and Bridges",Object(c.jsx)("br",{}),Object(c.jsx)("input",{type:"checkbox",id:"sewer_and_waterCheck",value:"sewer_and_water",onChange:this.handleAttribute})," Sewer and Water",Object(c.jsx)("br",{}),Object(c.jsx)("input",{type:"checkbox",id:"buildingsCheck",value:"buildings",onChange:this.handleAttribute})," Buildings",Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsx)("span",{children:"w/o uncertainty:"}),Object(c.jsx)("br",{}),Object(c.jsx)("input",{type:"radio",name:"uncertaintyRadio",id:"noUncertaintyRadio",value:"noUncertainty",onChange:this.handleUncertainty})," Damage reported ",Object(c.jsx)("br",{}),Object(c.jsx)("div",{id:"colorLegend"}),Object(c.jsx)("input",{type:"radio",name:"uncertaintyRadio",id:"uncertaintyRadio",value:"uncertainty",onChange:this.handleUncertainty})," Damage reported + Uncertainty",Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsx)("div",{id:"vsupLegend"})]})]})}}]),n}(r.a.Component),f=n(136),x=n.n(f),v=(n(279),function(t){Object(p.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(d.a)(this,n),(a=e.call(this,t)).handleSelectRegion=function(t){console.log("select region ",t),a.setState({selectedRegion:t})},a.state={selectedRegion:[0,""]},a}return Object(l.a)(n,[{key:"render",value:function(){var t=this,e=45,n=window,a=n.innerWidth;n.innerHeight;return Object(c.jsx)("div",{children:Object(c.jsxs)(g.a,{className:"layout",layout:[{i:"a",x:0,y:0,w:6,h:9},{i:"b",x:6,y:0,w:6,h:9},{i:"c",x:0,y:9,w:12,h:4},{i:"d",x:0,y:13,w:12,h:4},{i:"e",x:0,y:17,w:12,h:27}],cols:12,rowHeight:e,margin:[5,1],width:a,children:[Object(c.jsx)("div",{children:Object(c.jsxs)("div",{class:"card",style:{height:405},children:[Object(c.jsx)("p",{style:{backgroundColor:"#e9ecef",margin:"5px",paddingLeft:"5px"},children:"City Map"}),Object(c.jsx)(j,{onSelectRegion:function(e){return t.handleSelectRegion(e)}})]})},"a"),Object(c.jsx)("div",{children:Object(c.jsxs)("div",{class:"card",style:{height:405},children:[Object(c.jsx)("p",{style:{backgroundColor:"#e9ecef",margin:"5px",paddingLeft:"5px"},children:"Radar Chart"}),Object(c.jsxs)("div",{class:"row",style:{marginLeft:30,marginTop:10},children:[Object(c.jsx)("div",{class:"col-8",children:Object(c.jsx)(x.a,{captions:{buildings:"buildings",medical:"medical",sewer_and_water:"sewer and water",roads_and_bridges:"roads and bridges",power:"power"},data:[{data:{buildings:.4,medical:.7,sewer_and_water:.4,roads_and_bridges:.8,power:.5},meta:{color:"#fc9272"}}],size:360,options:{captionProps:function(){return{className:"caption",textAnchor:"middle",fontSize:15,fontFamily:"sans-serif"}}}})}),Object(c.jsx)("div",{class:"col-4",children:Object(c.jsx)("h3",{children:this.state.selectedRegion[1]})})]})]})},"b"),Object(c.jsx)("div",{children:Object(c.jsx)("div",{class:"card",style:{height:180},children:Object(c.jsx)("p",{style:{backgroundColor:"#e9ecef",margin:"5px",paddingLeft:"5px"},children:"# of Reports"})})},"c"),Object(c.jsx)("div",{children:Object(c.jsx)("div",{class:"card",style:{height:180},children:Object(c.jsx)("p",{style:{backgroundColor:"#e9ecef",margin:"5px",paddingLeft:"5px"},children:"Shaking Intensity"})})},"d"),Object(c.jsx)("div",{children:Object(c.jsxs)("div",{class:"card",style:{height:1215},children:[Object(c.jsx)("p",{style:{backgroundColor:"#e9ecef",margin:"5px",paddingLeft:"5px"},children:"Heatmap"}),Object(c.jsx)(y,{})]})},"e")]})})}}]),n}(r.a.Component));o.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(v,{})}),document.getElementById("root")),s()}},[[280,1,2]]]);
//# sourceMappingURL=main.a4b1c84b.chunk.js.map